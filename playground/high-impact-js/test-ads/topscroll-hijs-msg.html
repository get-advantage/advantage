<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>High Impact JS Message Test - Topscroll</title>
        <style>
            html,
            body {
                margin: 0;
                padding: 0;
                height: 100vh;
                width: 100vw;
                cursor: pointer;
            }
        </style>
    </head>

    <body
        style="opacity: 0; transition: opacity 1s ease-in"
        onclick="window.open('https://www.get-advantage.org', '_blank')"
    >
        <picture style="display: block; height: 100vh; width: 100vw">
            <source
                srcset="../../../public/fullscreen-landscape.png"
                media="(orientation: landscape)"
            />
            <source
                srcset="../../../public/fullscreen-portrait.png"
                media="(orientation: portrait)"
            />
            <img
                alt="banner image"
                src="../../../public/fullscreen-portrait.png"
                style="
                    width: 100%;
                    height: 100%;
                    object-fit: cover;
                    object-position: center center;
                "
            />
        </picture>

        <div
            style="
                position: absolute;
                top: 10px;
                left: 10px;
                background: rgba(255, 255, 255, 0.8);
                padding: 5px;
                font-size: 12px;
                border-radius: 3px;
            "
        >
            High Impact JS Message (Topscroll)
        </div>

        <script>
            function sendHighImpactJSMessage() {
                console.log(
                    "ðŸ“¨ Sending High Impact JS message for topscroll..."
                );

                // Show the ad
                document.body.style.opacity = "1";

                // Wait a bit for the ad to be visible
                setTimeout(() => {
                    // Send the original High Impact JS message format (as JSON string)
                    const message = {
                        sender: "high-impact-js",
                        action: "AD_RENDERED",
                        origins: [],
                        qemId: null,
                        iframeName: null
                    };

                    // Try to get iframe name
                    try {
                        message.iframeName = window.frameElement?.name;
                    } catch (_) {}

                    // Try to get origins
                    try {
                        message.origins = Array.from([
                            ...(location.ancestorOrigins || []),
                            window.location.origin
                        ]);
                    } catch (_) {}

                    console.log(
                        "ðŸ“¤ Sending High Impact JS message (topscroll):",
                        message
                    );

                    // Send as JSON string (original High Impact JS format)
                    window.top?.postMessage(JSON.stringify(message), "*");
                }, 1); // Reduced to 1ms for ultra-fast testing
            }

            // Send message when page loads
            sendHighImpactJSMessage();
        </script>
    </body>
</html>
